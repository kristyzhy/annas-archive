{% extends "layouts/index.html" %}

{% block title %}Torrents{% endblock %}

{% block body %}
  {% if gettext('common.english_only') != 'Text below continues in English.' %}
    <p class="mb-4 font-bold">{{ gettext('common.english_only') }}</p>
  {% endif %}

  <div lang="en">
    <h2 class="mt-4 mb-1 text-3xl font-bold">Torrents</h2>

    <p class="mb-4">
      These are all the torrents currently managed and released by Annaâ€™s Archive. For more information, see â€œOur projectsâ€ on the <a href="/datasets">Datasets</a> page. For Library Genesis and Sci-Hub torrents, the <a href="https://libgen.li/torrents/">Libgen.li torrents page</a> maintains an overview.
    </p>

    <p class="mb-4">
      These torrents are <span class="underline">not meant for downloading individual books</span>. They are meant for long-term preservation. If you donâ€™t know what to do with these torrents, they are not for you. :)
    </p>

    <p class="mb-4">
      Torrents with â€œaacâ€ in the filename use the <a href="https://annas-blog.org/annas-archive-containers.html">Annaâ€™s Archive Containers format</a>. Torrents that are crossed out have been superseded by newer torrents, for example because newer metadata has become available.
    </p>

    <table>
      {% for group, small_files in small_file_dicts_grouped.items() %}
        <tr><td colspan="100"><span class="mt-4 mb-1 text-xl font-bold" id="{{ group | replace('/', '__') }}">{{ group }}</span> <span class="text-xs text-gray-500">{{ group_size_strings[group] }}</span> <a href="#{{ group | replace('/', '__') }}" class="custom-a invisible [td:hover>&]:visible text-gray-400 hover:text-gray-500 text-sm align-[2px]">Â§</a></td></tr>

        {% for small_file in small_files %}
          <tr class="{% if small_file.file_path in obsolete_file_paths %}line-through{% endif %}"><td colspan="100" class="pb-1 max-sm:break-all"><a href="/small_file/{{ small_file.file_path }}">{{ small_file.file_path }}</a></td></tr>
          <tr>
            <td class="text-sm pb-1 pl-2 whitespace-nowrap">{{ small_file.created | datetimeformat('yyyy-MM-dd') }}</td><td class="text-sm pb-1 pl-2 whitespace-nowrap">{{ small_file.size_string }}</td>
            <td class="text-sm pb-1 pl-2 whitespace-nowrap"><a href="magnet:?xt=urn:btih:{{ small_file.metadata.btih }}&dn={{ small_file.display_name | urlencode }}&tr=udp://tracker.opentrackr.org:1337/announce">magnet</a></td>
            <td class="text-sm pb-1 pl-2 whitespace-nowrap">{% if small_file.scrape_metadata.scrape %}<span class="text-[10px] leading-none align-[2px]">{% if small_file.scrape_metadata.scrape.seeders < 4 %}<span title="<4 seeders">ğŸ”´</span>{% elif small_file.scrape_metadata.scrape.seeders < 11 %}<span title="4-10 seeders">ğŸŸ¡</span>{% else %}<span title=">10 seeders">ğŸŸ¢</span>{% endif %}</span> {{ small_file.scrape_metadata.scrape.seeders }} seed / {{ small_file.scrape_metadata.scrape.leechers }} leech <span class="text-xs text-gray-500" title="{{ small_file.scrape_created | datetimeformat(format='long') }}">{{ small_file.scrape_created_delta | timedeltaformat(add_direction=True) }}</span>{% endif %}</td>
          </tr>
        {% endfor %}
      {% endfor %}
    </table>
  </div>
{% endblock %}
